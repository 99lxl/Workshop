AC-CV组 第二次组内分享



> 主题：Recent advances in deep learning for object detection 论文分享

> 汇报人：曹至欣 

> 汇报时间：2021-10-21

# 1.目标检测简介

## 1.1 目标检测的背景

### 1.1.1 CV领域4个基本识别问题

1. 图像分类

- 任务：在给定图片中识别物体的语义类别（eg.这张图片里面是牛）
- 与目标检测的区别：不预测每个独立物体的位置

2. 目标检测

- 任务：识别物体的语义类别 + 通过边界框预测每个独立物体的位置

3. 语义分割

- 任务：预测一个像素级别的分类器为每个像素划分特定的类别
- 与目标检测的区别：不区分同一类别的多个物体

4. 实例分割

- 特点：语义分割与目标检测的交叉
- 任务：区分不同物体+给每个独立的物体分配一个像素级mask
- 与目标检测的区别：可认为是目标检测的特殊设置，用像素级别定位取代了边界框定位

### 1.1.2 目标检测的重要性及意义

- 一个好的检测算法应该能很好地掌握语义信息及图像的空间信息
- 目标检测是众多计算机视觉领域应用问题的基础步骤
  - 人脸识别、行人识别、视频分析、标志识别等

## 1.2 目标检测常用的方法

### 1.2.1 传统的目标检测方法

- 深度学习出现之前目标检测的流程

1. 提案生成

- 任务：找到ROI（regions of interest）即图像中包含对象的可能的位置
- 方法：用滑动窗口去扫描整个图像
  - 细节：为了获取目标的多尺度和不同长宽比的信息，将输入图像调整为不同的尺度，并使用多尺度窗口在这些图像中滑动

2. 特征向量提取

- 任务：通过滑动窗口从图像的每个位置获取固定大小的特征向量，以获取判别性语义信息
- 特点：特征向量通常由SIFT、Haar等低级视觉描述符编码，对旋转、光照等具有一定的鲁棒性

3. 区域分类

- 训练区域分类器将分类标签分配给覆盖的区域
- 主要关注和研究的方向：如何设计特征描述子以获得感兴趣区域的特征信息
  - 一个突破性的检测算法：DPMs（deformable part based machines)
  - 但是在2008年至2012年期间，不断增加的进展通过构建复杂的集成系统所获得的收益很小
- 局限性

1. 提案生成步骤生成了许多多余的提案，影响分类过程的准确度
2. 滑动窗口的大小是人为设计的，具有启发性不能很好地匹配对象
3. 特征描述子是基于低级视觉线索手工构建的，很难在复杂的上下文中捕捉到代表性的语义信息
4. 流程中每一个步骤是独立设计和优化的，无法获得整个系统的全局最优解

### 1.2.2 深度学习的目标检测方法

- 背景：深度卷积神经网络成功应用于图像分类推动了深度学习方法在目标检测领域的进步
- 优点：
  - 在复杂的上下文中表现出了更强大的鉴别表达能力
  - 强大的学习能力使得能够在较大的数据集上获得更好的特征表示（传统方法学习能力是固定的，更多数据集并不能导致学习能力的提高）
  - 能够进行端到端的优化
- 两大主流目标检测框架
  - 两级检测器
    - 代表模型：R-CNN
    - 特点：更好的检测性能，并在公共基准上报告最新的结果
  - 一级检测器
    - 代表模型：YOLO
    - 特点：更高的时间效率，更适用于实时目标检测

# 2.检测组件

## 2.1 检测设置

- 一般的目标检测（bbox级别定位）
  - 传统的目标检测设置
  - 目标：通过一个矩形边界框对目标进行定位

评价：通过预测边界框与groundtruth之间的IoU衡量性能

- 特殊的目标检测（实例分割，像素级别或掩码级别定位）
  - 相对较新的目标检测设置
  - 目标：像素级掩码来分割每个对象而不是用粗糙的矩形框
  - 特点：更精确的像素级预测，所以对空间处理信息能力要求更高
  - 评价：与bbox级别评价指标大致相同，只不过是在掩码预测上进行的

## 2.2 两种检测模式

1. 两阶段检测器

- 第一阶段：生成稀疏的提案集
- 第二阶段：通过神经网络对生成提案的特征向量进行编码，然后进行分类预测

2. 一阶段检测器

- 与两阶段的区别：没有两阶段检测器的第一阶段即单独的提案生成阶段
- 思想：将图像中的所有位置视为潜在的对象，并尝试为每个ROI（即感兴趣的区域）分类成背景或潜在的对象

## 2.3 提案(proposal)生成器

生成的提案在整个目标检测框架中起着非常重要的作用，因为他生成矩形边框来对对象的位置进行定位。

### 2.3.1 传统的计算机视觉方法

传统的计算机视觉方法都是基于低级线索（例如边缘、角、颜色等）生成提议

1. 基于对象分数的方法

- 针对每个候选框给出一个分数，表示他可能包含一个对象的可能性
- eg.基于视觉线索的分类（颜色对比度，边缘密度。。）

2. 超像素合并的方法

- 合并从分割结果中生成的超像素
- 选择性搜索是一种基于超像素合并的提案生成算法
- eg.计算分割方法生成的多个层次段，根据视觉因素（颜色，区域等）进行合并，然后将边界框放在合并的段

3. 种子分割的方法

- 对于每个种子区域生成对每个种子的前景和背景分割结果
- eg.与超像素合并的方法结合，将超像素方法合并的片段作为种子生成更大的分割片段

### 2.3.2 基于锚点（anchor）的方法

一大类有监督的方案生成器是基于 anchor 的方法，它们基于预定义的锚生成提案

- anchor:initial estimates of bounding box
- eg.RPN（Region Proposal Network ）基于深度卷积特征图并以监督方式生成提议。网络滑过整个特征图，使用 3 × 3 卷积滤波器,对于每个位置，k 个不同大小和纵横比的锚点（边界框的初始值）被考虑在内，基于groundtruth边界框，使用最合适的锚来获得用于锚估计的监督信号并匹配对象位置

### 2.3.3 基于关键点检测的方法

1. 基于角点的方法

- 通过合并从特征地图中学习到的角点对来预测边界框
- eg.建立了四种角点类型（左上角、右上角、左下角、右下角）的分布模型，并在对象的每个角点上应用朴素贝叶斯分类器来估计包围盒的置信度

2. 基于中心点的方法

- 在特征地图的每个位置上预测目标成为中心的概率，在不使用任何锚定先验的情况下直接回归高度和宽度

## 2.4 特征表示学习

特征表示学习是整个检测框架的重要组成部分。目标对象处于复杂的环境中，其尺度和纵横比变化较大。为了获得良好的检测性能，需要训练具有鲁棒性和鉴别能力的目标特征嵌入。

### 2.4.1 多尺度特征表示学习

深度卷积网络学习不同层的层次特征，捕获不同的尺度信息；在检测小物体时，需要高分辨率的表示，而这些物体的表示在深层特征中甚至可能不可用，从而使小物体检测变得困难；在没有足够大的感受野的情况下，检测浅层中的大型物体也是非最佳的。四种主要的模式可以解决多尺度特征学习的问题：

1. 图像金字塔

- 一个直观的想法是将输入图像调整为多个不同的尺度（图像金字塔）并训练多个检测器，每个检测器负责一定的尺度范围，测试时同上但需要合并检测结果

- eg.学习了一个轻量级的尺度感知网络来调整图像的大小，接下来学习单尺度检测器

2. 预测金字塔

- 将来自多个层的粗细特征组合在一起，预测是由多层进行的，其中每一层负责一定规模的对象

- eg.利用适当的特征图来生成一定比例的目标提议和多个尺度相关的分类器来预测对象。在他们的工作中，学习了级联拒绝分类器在早期阶段拒绝简单的背景建议以加速检测速度。

3. 集成特征

- 通过组合多层中的特征并基于新构建的地图进行最终预测来构建单个特征图，通过融合空间丰富的浅层特征和语义丰富的深层特征,新构建的特征包含丰富的信息，因此可以检测不同尺度的物体。

- eg.通过 ROI Pooling从不同层裁剪区域特征，并结合这些多尺度用于最终预测的区域特征

4. 特征金字塔

- 以自上而下的方式将不同尺度的特征与横向连接相结合，以构建一组尺度不变的特征图，并在这些特征金字塔上学习了多个尺度相关的分类器
- eg.集成不同尺度特征的网络（FPN）以自上而下的方式横向连接以构建集合尺度不变特征图，和多个尺度相关分类器是在这些特征金字塔上学习的。

### 2.4.2 上下文推理

1. 全局上下文推理

- 从整个图像中的上下文中学习， 与试图将图像中的特定区域分类为对象的传统检测器不同，这里的想法是使用上下文信息（即来自图像其余部分的信息）来对特定的感兴趣区域进行分类（从图像中识别棒球很难，可能和其他混淆，但如果使用棒球场，球员球棒则更容易识别棒球）

- eg.学习每个图像的分类分数，用作与对象检测结果连接的上下文特征

2. 区域上下文推理

- 对区域周围的上下文信息进行编码，并学习对象与其周围区域之间的交互

- eg.空间记忆网络（SMN）引入了一个基于空间记忆的模块。空间记忆模块通过将姿势中的对象组装回伪“图像”表示来捕获实例级上下文，这些表示后来用于对象关系推理

### 2.4.3 区域特征编码

### 2.4.4 可变形特征学习

一个好的检测器应该对物体的非刚性变形具有鲁棒性。

- eg.设计了可变形卷积层，它自动学习辅助位置偏移，以增加在特征图的常规采样位置采样的信息。

# 3.学习策略

## 3.1 训练阶段

### 3.1.1 数据增强

- 在目标检测中，为了增加训练数据并生成具有多个视觉属性的训练块，训练图像的水平翻转
- eg.单级检测器中使用了更密集的数据增强策略：旋转，随机裁剪，扩展，颜色抖动

### 3.1.2 不平衡采样

出现了两个需要解决的问题：

- 类别不平衡
  -  它们中很少有正实例（或对象）。 这会导致训练检测器时出现不平衡问题
- 难度不平衡
  - 与第一个问题密切相关，由于类不平衡，大多数背景建议变得容易分类，而对象变得更难分类
  - 为了解决难度不平衡的问题，大多数采样策略都基于精心设计的损失函数

### 3.1.3 定位细化

对象检测器必须为每个对象提供严格的定位预测（bbox 或掩码），为此许多努力改进了初步提案预测以改进定位，精确定位具有挑战性，因为预测通常集中在对象中最具辨别力的部分，而不一定是包含对象的区域，定位细化的一般方法是生成高质量的提案

- eg.引入迭代边界框回归方法，其中应用 R-CNN 来改进学习的预测

### 3.1.4 级联学习

级联学习是一种从粗到精的学习策略，它从给定分类器的输出中收集信息，以级联方式构建更强的分类器

- eg.为不同层中不同比例的对象引入了逐层级联分类器。多个分类器是放置在不同的特征图上，分类器上的较浅层会拒绝简单的否定，剩余的样本将是送入更深层进行分类

### 3.1.5 其他学习策略

1. 对抗性学习

-  应用对抗学习最著名的工作是生成对抗网络 (GAN) ，其中生成器与鉴别器竞争。

- GAN：生成器尝试通过使用噪声向量输入生成假图像来对数据分布进行建模，并使用这些假图像来混淆判别器，而判别器与生成器竞争从假图像中识别真实图像
- eg.针对小物体目标检测的Perceptual GAN。可学习的生成器通过对抗性方案学习高分辨率对小物体的特征表示。具体来说，它的生成器学会了将低分辨率的小区域特征转化为高分辨率特征并与真正高分辨率特征的鉴别器竞争识别。

2. 从头开始训练

- 从头开始训练出现的原因：
  - 现代目标检测器严重依赖于预训练分类模型

- 损失函数的偏差以及分类和检测之间的数据分布会对性能产生对抗性影响。

- 在新领域中转移用于检测的分类模型可能会带来更多挑战（从 RGB 到 MRI 数据等）
- 从头开始训练的主要困难：
  - 物体检测的训练数据往往不足，可能导致过拟合
  - 注释大规模检测数据集需要更多的精力和时间

3. 知识蒸馏

- 将模型集合中的知识提炼成通过teacher-student训练计划的单一模式

- eg.提出了一种基于 Faster R-CNN 的检测器，它是通过teacher-student训练计划优化。一个 R-CNN 模型用作教师网络来指导培训过程。这个模型框架与传统的单一模型优化策略相比检测精度有所提高。

## 3.2 测试阶段

### 3.2.1 重复去除

- 非最大抑制 (NMS) 是对象检测的一个组成部分，用于消除重复的假阳性预测
- 对象检测算法使用多个重复预测进行一组密集的预测
  - 对于生成一组密集提案的单阶段检测算法，围绕同一对象的提案具有相似的置信度分数，导致误报
  - 对于生成稀疏提议集的两阶段检测算法，边界框回归器会将这些建议拉近同一对象，从而导致相同的问题。 

重复的预测被视为误报，在评估中会受到惩罚，因此需要 NMS 去除这些重复的预测。 具体来说，对于每个类别，根据置信度得分对预测框进行排序，并选择得分最高的框。

### 3.2.2 模型加速

两级检测器通常比一级检测器慢，因为它们有两个阶段——一个提议生成和一个区域分类，这使得它们在计算上比单阶段更耗时

- eg.Light Head R-CNN，它显着减少了数量最终特征图中的通道数（从 1024 到 16）.而不是共享所有计算。尽管计算没有跨区域分享，但是开销是可以忽略不计的。

### 3.2.3 其他方法

测试阶段的其他学习策略主要包括对输入图像进行变换以提高检测精度

- 图像金字塔 是一种广泛使用的提高检测结果的技术，它在不同的位置构建分层图像集。对所有这些图像进行缩放和预测。最终的检测结果是从每个图像的预测中合并而来的

# 4.检测基准

## 4.1 通用检测基准

- Pascal VOC2007 中等规模的数据集（训练，验证，测试）
- Pascal VOC2012中等规模的数据集（与2007共享相同的20个类别）
- MSCOCO 大规模数据集
- Open Images
- LVIS
- ImageNet
- 评价指标：
  - 检测速度
    - 均值平均精度（mAP)AP 是 AP 的平均值，计算方法是根据召回率和准确率分别针对每个类别。AP是根据真阳性假阳性数量画出的精度曲线下的区域面积，mAP是通过计算所有AP值得平均值获得的
  - 推理速度

## 4.2 SOTA

![img](https://z0ad5y8wj2.feishu.cn/space/api/box/stream/download/asynccode/?code=MmNkMzQ2ZmFkMDk3OTM1MDFmOWUxNjc2NTE1YTM0ODRfSDJQdGhvVzBDeTRsbW5EbnpTaHphVlh4Sjlmc3hXVThfVG9rZW46Ym94Y25mbjZxZ2tSQTk3dkRxeE5pcTRWZjFnXzE2MzQ5NTIwMzk6MTYzNDk1NTYzOV9WNA)

![img](https://z0ad5y8wj2.feishu.cn/space/api/box/stream/download/asynccode/?code=MDg1ZTA5NzkwYzEwMWQzOGE0Yjg5YWJiNGQwNTJjNzVfcGlSWXMyRGpFdjBDa1VYSU9PM0hTN2VkTlZqbElKbE9fVG9rZW46Ym94Y25EYWxPSE83ckk1dU9pVDlhdVI0UkdlXzE2MzQ5NTIwMzk6MTYzNDk1NTYzOV9WNA)



# 5.展望未来方向

1. 可扩展的提案生成策略

- 目前大多数检测器都是基于锚的方法，并且存在一些严重的缺点，限制了检测精度

- 虽然有些已经提出了一些方法来转换基于锚的方法进入无锚方法（例如基于关键点的方法），仍然有一些（高计算成本等）改进的空间。

2. 上下文信息的有效编码

- 很少努力一直专注于如何正确使用上下文信息。如何有效地结合对象检测的上下文可以是一个充满希望的未来方向

3. 基于自动机器学习的检测（AutoML）

- AutoML：一个完整的机器学习流程通常包含四步：数据准备、特征工程、模型生成、模型评估。每一步都无法省略，每一步都有无数的问题需要解决。于是人们找到了 AutoML，希望机器能自己解决这一切。AutoML 全称“自动机器学习”（Auto Machine Learning），指的是根据任务目标自动实现模型构建、筛选的技术。

- 无法负担 AutoML 所需的计算资源，开发低计算框架应具有对物体检测有很大影响

4. 新兴的物体检测基准

- 目前 MSCOCO是最常用的检测基准测试平台。然而MSCOCO只有80个品类，还是太少了

5. 低样本目标检测

- 具有有限标记数据的训练检测器被称为低样本检测

- 基于深度学习检测器通常有大量的参数，需要大量标记数据才能实现令人满意的表现
- 已被积极研究用于分类任务，但仅一些研究集中在检测任务上，仍有很大的提升空间

6. 检测任务的主干架构

- 它已成为一个采用在大规模数据集上预先训练的分类模型的权重进行检测的常见做法。然而，仍有分类和检测任务之间存在冲突，并且因此直接采用预训练的网络可能不会导致最优解。

- 大多数最先进的检测算法都是基于分类主干的，只有少数他们尝试不同的选择。因此，开发检测感知骨干架构也是未来的一个重要研究方向

7. 其他研究问题

- 对于增量学习，检测算法仍然遭受灾难性遗忘，如果适应没有初始训练数据的新任务。这些开放和未来的基础研究问题也值得更多关注工作
